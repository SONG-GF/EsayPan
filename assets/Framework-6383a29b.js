import{a as G,u as K,b as Q,r as g,e as S,f as h,h as y,i,F as T,j as _,w as m,m as E,q as Y,t as D,n as Z,g as ue,_ as ee,x as H,k as L,l as M,y as j,z as X,A as O,s as te,v as ae,B as ce,C as de}from"./index-c2f02e87.js";const pe={class:"avatar-upload"},fe={class:"avatar-show"},he=["src"],_e=["src"],ve=["src"],me={class:"select-btn"},ye={__name:"AvatarUpload",props:{modelValue:{type:Object,default:null}},setup(U,{emit:I}){G(),K(),Q(),g("");const F=g(null),P=async p=>{p=p.file;let l=new FileReader;l.readAsDataURL(p),l.onload=({target:w})=>{F.value=w.result},I("update:modelValue",p)};return(p,l)=>{const w=S("el-button"),V=S("el-upload");return h(),y("div",pe,[i("div",fe,[F.value?(h(),y("img",{key:0,src:F.value},null,8,he)):(h(),y(T,{key:1},[U.modelValue&&U.modelValue.qqAvatar?(h(),y("img",{key:0,src:`${U.modelValue.qqAvatar}`},null,8,_e)):(h(),y("img",{key:1,src:`/api/getAvatar/${U.modelValue.userId}`},null,8,ve))],64))]),i("div",me,[_(V,{name:"file","show-file-list":!1,accept:".png,.PNG,.jpg,.JPG,.jpeg,.JPEG,.gif,.GIF,.bmp,.BMP",multiple:!1,"http-request":P},{default:m(()=>[_(w,{type:"primary"},{default:m(()=>[E("选择")]),_:1})]),_:1})])])}}},ge={__name:"UpdateAvatar",emits:["updateAvatar"],setup(U,{expose:I,emit:F}){const{proxy:P}=G();K(),Q();const p={updateUserAvatar:"updateUserAvatar"},l=g({}),w=g();I({show:b=>{l.value=Object.assign({},b),l.value.avatar={userId:b.userId,qqAvatar:b.avatar},k.value.show=!0}});const k=g({show:!1,title:"修改头像",buttons:[{type:"primary",text:"确定",click:b=>{R()}}]}),R=async()=>{if(!(l.value.avatar instanceof File)){k.value.show=!1;return}if(!await P.Request({url:p.updateUserAvatar,params:{avatar:l.value.avatar}}))return;k.value.show=!1;const f=P.VueCookies.get("userInfo");delete f.avatar,P.VueCookies.set("userInfo",f,0),F("updateAvatar")};return(b,f)=>{const v=S("el-form-item"),C=S("el-form"),B=S("Dialog");return h(),y("div",null,[_(B,{show:k.value.show,title:k.value.title,buttons:k.value.buttons,width:"500px",showCancel:!0,onClose:f[2]||(f[2]=u=>k.value.show=!1)},{default:m(()=>[_(C,{model:l.value,ref_key:"formDataRef",ref:w,"label-width":"80px",onSubmit:f[1]||(f[1]=Y(()=>{},["prevent"]))},{default:m(()=>[_(v,{label:"昵称",prop:""},{default:m(()=>[E(D(l.value.nickName),1)]),_:1}),_(v,{label:"头像",prop:""},{default:m(()=>[_(ye,{modelValue:l.value.avatar,"onUpdate:modelValue":f[0]||(f[0]=u=>l.value.avatar=u)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show","title","buttons"])])}}},we=i("span",{class:"iconfont icon-password"},null,-1),be=i("span",{class:"iconfont icon-password"},null,-1),Ce={__name:"UpdatePassword",setup(U,{expose:I}){const{proxy:F}=G(),P={updatePassword:"updatePassword"},p=g({}),l=g(),w=(f,v,C)=>{v!==p.value.rePassword?C(new Error(f.message)):C()},V={password:[{required:!0,message:"请输入密码"},{validator:F.Verify.password,message:"密码只能是数字，字母，特殊字符 8-18位"}],rePassword:[{required:!0,message:"请再次输入密码"},{validator:w,message:"两次输入的密码不一致"}]};I({show:()=>{R.value.show=!0,Z(()=>{l.value.resetFields(),p.value={}})}});const R=g({show:!1,title:"修改密码",buttons:[{type:"primary",text:"确定",click:f=>{b()}}]}),b=async()=>{l.value.validate(async f=>{!f||!await F.Request({url:P.updatePassword,params:{password:p.value.password}})||(R.value.show=!1,F.Message.success("密码修改成功"))})};return(f,v)=>{const C=S("el-input"),B=S("el-form-item"),u=S("el-form"),r=S("Dialog");return h(),y("div",null,[_(r,{show:R.value.show,title:R.value.title,buttons:R.value.buttons,width:"500px",showCancel:!0,onClose:v[3]||(v[3]=o=>R.value.show=!1)},{default:m(()=>[_(u,{model:p.value,rules:V,ref_key:"formDataRef",ref:l,"label-width":"80px",onSubmit:v[2]||(v[2]=Y(()=>{},["prevent"]))},{default:m(()=>[_(B,{label:"新密码",prop:"password"},{default:m(()=>[_(C,{type:"password",size:"large",placeholder:"请输入密码",modelValue:p.value.password,"onUpdate:modelValue":v[0]||(v[0]=o=>p.value.password=o),"show-password":""},{prefix:m(()=>[we]),_:1},8,["modelValue"])]),_:1}),_(B,{label:"确认密码",prop:"rePassword"},{default:m(()=>[_(C,{type:"password",size:"large",placeholder:"请再次输入密码",modelValue:p.value.rePassword,"onUpdate:modelValue":v[1]||(v[1]=o=>p.value.rePassword=o),"show-password":""},{prefix:m(()=>[be]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show","title","buttons"])])}}};var se={exports:{}};(function(U,I){(function(F){U.exports=F()})(function(F){var P=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function p(o,n){var t=o[0],e=o[1],s=o[2],a=o[3];t+=(e&s|~e&a)+n[0]-680876936|0,t=(t<<7|t>>>25)+e|0,a+=(t&e|~t&s)+n[1]-389564586|0,a=(a<<12|a>>>20)+t|0,s+=(a&t|~a&e)+n[2]+606105819|0,s=(s<<17|s>>>15)+a|0,e+=(s&a|~s&t)+n[3]-1044525330|0,e=(e<<22|e>>>10)+s|0,t+=(e&s|~e&a)+n[4]-176418897|0,t=(t<<7|t>>>25)+e|0,a+=(t&e|~t&s)+n[5]+1200080426|0,a=(a<<12|a>>>20)+t|0,s+=(a&t|~a&e)+n[6]-1473231341|0,s=(s<<17|s>>>15)+a|0,e+=(s&a|~s&t)+n[7]-45705983|0,e=(e<<22|e>>>10)+s|0,t+=(e&s|~e&a)+n[8]+1770035416|0,t=(t<<7|t>>>25)+e|0,a+=(t&e|~t&s)+n[9]-1958414417|0,a=(a<<12|a>>>20)+t|0,s+=(a&t|~a&e)+n[10]-42063|0,s=(s<<17|s>>>15)+a|0,e+=(s&a|~s&t)+n[11]-1990404162|0,e=(e<<22|e>>>10)+s|0,t+=(e&s|~e&a)+n[12]+1804603682|0,t=(t<<7|t>>>25)+e|0,a+=(t&e|~t&s)+n[13]-40341101|0,a=(a<<12|a>>>20)+t|0,s+=(a&t|~a&e)+n[14]-1502002290|0,s=(s<<17|s>>>15)+a|0,e+=(s&a|~s&t)+n[15]+1236535329|0,e=(e<<22|e>>>10)+s|0,t+=(e&a|s&~a)+n[1]-165796510|0,t=(t<<5|t>>>27)+e|0,a+=(t&s|e&~s)+n[6]-1069501632|0,a=(a<<9|a>>>23)+t|0,s+=(a&e|t&~e)+n[11]+643717713|0,s=(s<<14|s>>>18)+a|0,e+=(s&t|a&~t)+n[0]-373897302|0,e=(e<<20|e>>>12)+s|0,t+=(e&a|s&~a)+n[5]-701558691|0,t=(t<<5|t>>>27)+e|0,a+=(t&s|e&~s)+n[10]+38016083|0,a=(a<<9|a>>>23)+t|0,s+=(a&e|t&~e)+n[15]-660478335|0,s=(s<<14|s>>>18)+a|0,e+=(s&t|a&~t)+n[4]-405537848|0,e=(e<<20|e>>>12)+s|0,t+=(e&a|s&~a)+n[9]+568446438|0,t=(t<<5|t>>>27)+e|0,a+=(t&s|e&~s)+n[14]-1019803690|0,a=(a<<9|a>>>23)+t|0,s+=(a&e|t&~e)+n[3]-187363961|0,s=(s<<14|s>>>18)+a|0,e+=(s&t|a&~t)+n[8]+1163531501|0,e=(e<<20|e>>>12)+s|0,t+=(e&a|s&~a)+n[13]-1444681467|0,t=(t<<5|t>>>27)+e|0,a+=(t&s|e&~s)+n[2]-51403784|0,a=(a<<9|a>>>23)+t|0,s+=(a&e|t&~e)+n[7]+1735328473|0,s=(s<<14|s>>>18)+a|0,e+=(s&t|a&~t)+n[12]-1926607734|0,e=(e<<20|e>>>12)+s|0,t+=(e^s^a)+n[5]-378558|0,t=(t<<4|t>>>28)+e|0,a+=(t^e^s)+n[8]-2022574463|0,a=(a<<11|a>>>21)+t|0,s+=(a^t^e)+n[11]+1839030562|0,s=(s<<16|s>>>16)+a|0,e+=(s^a^t)+n[14]-35309556|0,e=(e<<23|e>>>9)+s|0,t+=(e^s^a)+n[1]-1530992060|0,t=(t<<4|t>>>28)+e|0,a+=(t^e^s)+n[4]+1272893353|0,a=(a<<11|a>>>21)+t|0,s+=(a^t^e)+n[7]-155497632|0,s=(s<<16|s>>>16)+a|0,e+=(s^a^t)+n[10]-1094730640|0,e=(e<<23|e>>>9)+s|0,t+=(e^s^a)+n[13]+681279174|0,t=(t<<4|t>>>28)+e|0,a+=(t^e^s)+n[0]-358537222|0,a=(a<<11|a>>>21)+t|0,s+=(a^t^e)+n[3]-722521979|0,s=(s<<16|s>>>16)+a|0,e+=(s^a^t)+n[6]+76029189|0,e=(e<<23|e>>>9)+s|0,t+=(e^s^a)+n[9]-640364487|0,t=(t<<4|t>>>28)+e|0,a+=(t^e^s)+n[12]-421815835|0,a=(a<<11|a>>>21)+t|0,s+=(a^t^e)+n[15]+530742520|0,s=(s<<16|s>>>16)+a|0,e+=(s^a^t)+n[2]-995338651|0,e=(e<<23|e>>>9)+s|0,t+=(s^(e|~a))+n[0]-198630844|0,t=(t<<6|t>>>26)+e|0,a+=(e^(t|~s))+n[7]+1126891415|0,a=(a<<10|a>>>22)+t|0,s+=(t^(a|~e))+n[14]-1416354905|0,s=(s<<15|s>>>17)+a|0,e+=(a^(s|~t))+n[5]-57434055|0,e=(e<<21|e>>>11)+s|0,t+=(s^(e|~a))+n[12]+1700485571|0,t=(t<<6|t>>>26)+e|0,a+=(e^(t|~s))+n[3]-1894986606|0,a=(a<<10|a>>>22)+t|0,s+=(t^(a|~e))+n[10]-1051523|0,s=(s<<15|s>>>17)+a|0,e+=(a^(s|~t))+n[1]-2054922799|0,e=(e<<21|e>>>11)+s|0,t+=(s^(e|~a))+n[8]+1873313359|0,t=(t<<6|t>>>26)+e|0,a+=(e^(t|~s))+n[15]-30611744|0,a=(a<<10|a>>>22)+t|0,s+=(t^(a|~e))+n[6]-1560198380|0,s=(s<<15|s>>>17)+a|0,e+=(a^(s|~t))+n[13]+1309151649|0,e=(e<<21|e>>>11)+s|0,t+=(s^(e|~a))+n[4]-145523070|0,t=(t<<6|t>>>26)+e|0,a+=(e^(t|~s))+n[11]-1120210379|0,a=(a<<10|a>>>22)+t|0,s+=(t^(a|~e))+n[2]+718787259|0,s=(s<<15|s>>>17)+a|0,e+=(a^(s|~t))+n[9]-343485551|0,e=(e<<21|e>>>11)+s|0,o[0]=t+o[0]|0,o[1]=e+o[1]|0,o[2]=s+o[2]|0,o[3]=a+o[3]|0}function l(o){var n=[],t;for(t=0;t<64;t+=4)n[t>>2]=o.charCodeAt(t)+(o.charCodeAt(t+1)<<8)+(o.charCodeAt(t+2)<<16)+(o.charCodeAt(t+3)<<24);return n}function w(o){var n=[],t;for(t=0;t<64;t+=4)n[t>>2]=o[t]+(o[t+1]<<8)+(o[t+2]<<16)+(o[t+3]<<24);return n}function V(o){var n=o.length,t=[1732584193,-271733879,-1732584194,271733878],e,s,a,d,A,c;for(e=64;e<=n;e+=64)p(t,l(o.substring(e-64,e)));for(o=o.substring(e-64),s=o.length,a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0;e<s;e+=1)a[e>>2]|=o.charCodeAt(e)<<(e%4<<3);if(a[e>>2]|=128<<(e%4<<3),e>55)for(p(t,a),e=0;e<16;e+=1)a[e]=0;return d=n*8,d=d.toString(16).match(/(.*?)(.{0,8})$/),A=parseInt(d[2],16),c=parseInt(d[1],16)||0,a[14]=A,a[15]=c,p(t,a),t}function k(o){var n=o.length,t=[1732584193,-271733879,-1732584194,271733878],e,s,a,d,A,c;for(e=64;e<=n;e+=64)p(t,w(o.subarray(e-64,e)));for(o=e-64<n?o.subarray(e-64):new Uint8Array(0),s=o.length,a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0;e<s;e+=1)a[e>>2]|=o[e]<<(e%4<<3);if(a[e>>2]|=128<<(e%4<<3),e>55)for(p(t,a),e=0;e<16;e+=1)a[e]=0;return d=n*8,d=d.toString(16).match(/(.*?)(.{0,8})$/),A=parseInt(d[2],16),c=parseInt(d[1],16)||0,a[14]=A,a[15]=c,p(t,a),t}function R(o){var n="",t;for(t=0;t<4;t+=1)n+=P[o>>t*8+4&15]+P[o>>t*8&15];return n}function b(o){var n;for(n=0;n<o.length;n+=1)o[n]=R(o[n]);return o.join("")}b(V("hello")),typeof ArrayBuffer<"u"&&!ArrayBuffer.prototype.slice&&function(){function o(n,t){return n=n|0||0,n<0?Math.max(n+t,0):Math.min(n,t)}ArrayBuffer.prototype.slice=function(n,t){var e=this.byteLength,s=o(n,e),a=e,d,A,c,$;return t!==F&&(a=o(t,e)),s>a?new ArrayBuffer(0):(d=a-s,A=new ArrayBuffer(d),c=new Uint8Array(A),$=new Uint8Array(this,s,d),c.set($),A)}}();function f(o){return/[\u0080-\uFFFF]/.test(o)&&(o=unescape(encodeURIComponent(o))),o}function v(o,n){var t=o.length,e=new ArrayBuffer(t),s=new Uint8Array(e),a;for(a=0;a<t;a+=1)s[a]=o.charCodeAt(a);return n?s:e}function C(o){return String.fromCharCode.apply(null,new Uint8Array(o))}function B(o,n,t){var e=new Uint8Array(o.byteLength+n.byteLength);return e.set(new Uint8Array(o)),e.set(new Uint8Array(n),o.byteLength),t?e:e.buffer}function u(o){var n=[],t=o.length,e;for(e=0;e<t-1;e+=2)n.push(parseInt(o.substr(e,2),16));return String.fromCharCode.apply(String,n)}function r(){this.reset()}return r.prototype.append=function(o){return this.appendBinary(f(o)),this},r.prototype.appendBinary=function(o){this._buff+=o,this._length+=o.length;var n=this._buff.length,t;for(t=64;t<=n;t+=64)p(this._hash,l(this._buff.substring(t-64,t)));return this._buff=this._buff.substring(t-64),this},r.prototype.end=function(o){var n=this._buff,t=n.length,e,s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],a;for(e=0;e<t;e+=1)s[e>>2]|=n.charCodeAt(e)<<(e%4<<3);return this._finish(s,t),a=b(this._hash),o&&(a=u(a)),this.reset(),a},r.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},r.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},r.prototype.setState=function(o){return this._buff=o.buff,this._length=o.length,this._hash=o.hash,this},r.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},r.prototype._finish=function(o,n){var t=n,e,s,a;if(o[t>>2]|=128<<(t%4<<3),t>55)for(p(this._hash,o),t=0;t<16;t+=1)o[t]=0;e=this._length*8,e=e.toString(16).match(/(.*?)(.{0,8})$/),s=parseInt(e[2],16),a=parseInt(e[1],16)||0,o[14]=s,o[15]=a,p(this._hash,o)},r.hash=function(o,n){return r.hashBinary(f(o),n)},r.hashBinary=function(o,n){var t=V(o),e=b(t);return n?u(e):e},r.ArrayBuffer=function(){this.reset()},r.ArrayBuffer.prototype.append=function(o){var n=B(this._buff.buffer,o,!0),t=n.length,e;for(this._length+=o.byteLength,e=64;e<=t;e+=64)p(this._hash,w(n.subarray(e-64,e)));return this._buff=e-64<t?new Uint8Array(n.buffer.slice(e-64)):new Uint8Array(0),this},r.ArrayBuffer.prototype.end=function(o){var n=this._buff,t=n.length,e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],s,a;for(s=0;s<t;s+=1)e[s>>2]|=n[s]<<(s%4<<3);return this._finish(e,t),a=b(this._hash),o&&(a=u(a)),this.reset(),a},r.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},r.ArrayBuffer.prototype.getState=function(){var o=r.prototype.getState.call(this);return o.buff=C(o.buff),o},r.ArrayBuffer.prototype.setState=function(o){return o.buff=v(o.buff,!0),r.prototype.setState.call(this,o)},r.ArrayBuffer.prototype.destroy=r.prototype.destroy,r.ArrayBuffer.prototype._finish=r.prototype._finish,r.ArrayBuffer.hash=function(o,n){var t=k(new Uint8Array(o)),e=b(t);return n?u(e):e},r})})(se);var Ae=se.exports;const Se=ue(Ae);const Ue=U=>(te("data-v-c4b41b7f"),U=U(),ae(),U),Fe={class:"uploader-panel"},$e=Ue(()=>i("div",{class:"uploader-title"},[i("span",null,"上传任务"),i("span",{class:"tips"},"（仅展示本次上传任务）")],-1)),xe={class:"file-list"},Ie={class:"file-item"},Pe={class:"upload-panel"},Be={class:"file-name"},ke={class:"progress"},Re={class:"upload-status"},Ve={key:0,class:"upload-info"},ze={class:"op"},De={class:"op-btn"},Me={key:0},Ne={key:0},N=1024*512,qe={__name:"Uploader",emits:["uploadCallback"],setup(U,{expose:I,emit:F}){const{proxy:P}=G(),p={upload:"/file/uploadFile"},l={emptyfile:{value:"emptyfile",desc:"文件为空",color:"#F75000",icon:"close"},fail:{value:"fail",desc:"上传失败",color:"#F75000",icon:"close"},init:{value:"init",desc:"解析中",color:"#e6a23c",icon:"clock"},uploading:{value:"uploading",desc:"上传中",color:"#409eff",icon:"upload"},upload_finish:{value:"upload_finish",desc:"上传完成",color:"#67c23a",icon:"ok"},upload_seconds:{value:"upload_seconds",desc:"秒传",color:"#67c23a",icon:"ok"}},w=g([]),V=g([]);I({addFile:async(u,r)=>{const o={file:u,uid:u.uid,md5Progress:0,md5:null,fileName:u.name,status:l.init.value,uploadSize:0,totalSize:u.size,uploadProgress:0,pause:!1,chunkIndex:0,filePid:r,errorMsg:null};if(w.value.unshift(o),o.totalSize==0){o.status=l.emptyfile.value;return}let n=await C(o);n!=null&&v(n)}});const R=u=>{let r=B(u);r.pause=!1,v(u,r.chunkIndex)},b=u=>{let r=B(u);r.pause=!0},f=(u,r)=>{V.value.push(u),w.value.splice(r,1)},v=async(u,r)=>{r=r||0;let o=B(u);const n=o.file,t=o.totalSize,e=Math.ceil(t/N);for(let s=r;s<e;s++){let a=V.value.indexOf(u);if(a!=-1){V.value.splice(a,1);break}if(o=B(u),o.pause)break;let d=s*N,A=d+N>=t?t:d+N,c=n.slice(d,A),$=await P.Request({url:p.upload,showLoading:!1,dataType:"file",params:{file:c,fileName:n.name,fileMd5:o.md5,chunkIndex:s,chunks:e,fileId:o.fileId,filePid:o.filePid},showError:!1,errorCallback:z=>{o.status=l.fail.value,o.errorMsg=z},uploadProgressCallback:z=>{let q=z.loaded;q>t&&(q=t),o.uploadSize=s*N+q,o.uploadProgress=Math.floor(o.uploadSize/t*100)}});if($==null)break;if(o.fileId=$.data.fileId,o.status=l[$.data.status].value,o.chunkIndex=s,$.data.status==l.upload_seconds.value||$.data.status==l.upload_finish.value){o.uploadProgress=100,F("uploadCallback");break}}},C=u=>{let r=u.file,o=File.prototype.slice||File.prototype.mozSlice||File.prototype.webkitSlice,n=Math.ceil(r.size/N),t=0,e=new Se.ArrayBuffer,s=new FileReader;new Date().getTime();let a=()=>{let d=t*N,A=d+N>=r.size?r.size:d+N;s.readAsArrayBuffer(o.call(r,d,A))};return a(),new Promise((d,A)=>{let c=B(r.uid);s.onload=$=>{if(e.append($.target.result),t++,t<n){let z=Math.floor(t/n*100);c.md5Progress=z,a()}else{let z=e.end();e.destroy(),c.md5Progress=100,c.status=l.uploading.value,c.md5=z,d(u.uid)}},s.onerror=()=>{c.md5Progress=-1,c.status=l.fail.value,d(u.uid)}}).catch(d=>null)},B=u=>w.value.find(o=>o.file.uid===u);return(u,r)=>{const o=S("el-progress"),n=S("icon"),t=S("NoData");return h(),y("div",Fe,[$e,i("div",xe,[(h(!0),y(T,null,H(w.value,(e,s)=>(h(),y("div",Ie,[i("div",Pe,[i("div",Be,D(e.fileName),1),i("div",ke,[e.status==l.uploading.value||e.status==l.upload_seconds.value||e.status==l.upload_finish.value?(h(),L(o,{key:0,percentage:e.uploadProgress},null,8,["percentage"])):M("",!0)]),i("div",Re,[i("span",{class:j(["iconfont","icon-"+l[e.status].icon]),style:X({color:l[e.status].color})},null,6),i("span",{class:"status",style:X({color:l[e.status].color})},D(e.status=="fail"?e.errorMsg:l[e.status].desc),5),e.status==l.uploading.value?(h(),y("span",Ve,D(O(P).Utils.size2Str(e.uploadSize))+"/"+D(O(P).Utils.size2Str(e.totalSize)),1)):M("",!0)])]),i("div",ze,[e.status==l.init.value?(h(),L(o,{key:0,type:"circle",width:50,percentage:e.md5Progress},null,8,["percentage"])):M("",!0),i("div",De,[e.status===l.uploading.value?(h(),y("span",Me,[e.pause?(h(),L(n,{key:0,width:28,class:"btn-item",iconName:"upload",title:"上传",onClick:a=>R(e.uid)},null,8,["onClick"])):(h(),L(n,{key:1,width:28,class:"btn-item",iconName:"pause",title:"暂停",onClick:a=>b(e.uid)},null,8,["onClick"]))])):M("",!0),e.status!=l.init.value&&e.status!=l.upload_finish.value&&e.status!=l.upload_seconds.value?(h(),L(n,{key:1,width:28,class:"del btn-item",iconName:"del",title:"删除",onClick:a=>f(e.uid,s)},null,8,["onClick"])):M("",!0),e.status==l.upload_finish.value||e.status==l.upload_seconds.value?(h(),L(n,{key:2,width:28,class:"clean btn-item",iconName:"clean",title:"清除",onClick:a=>f(e.uid,s)},null,8,["onClick"])):M("",!0)])])]))),256)),w.value.length==0?(h(),y("div",Ne,[_(t,{msg:"暂无上传任务"})])):M("",!0)])])}}},Le=ee(qe,[["__scopeId","data-v-c4b41b7f"]]);const W=U=>(te("data-v-2e64c336"),U=U(),ae(),U),je={class:"framework"},Te={class:"header"},Ee=W(()=>i("div",{class:"logo"},[i("span",{class:"iconfont icon-pan"}),i("span",{class:"name"},"云享盘")],-1)),Ge={class:"right-panel"},Oe=W(()=>i("span",{class:"iconfont icon-transfer"},null,-1)),Je={class:"user-info"},He={class:"avatar"},Ke={class:"nick-name"},Qe={class:"body"},We={class:"left-sider"},Xe={class:"menu-list"},Ye=["onClick"],Ze={class:"text"},et={class:"menu-sub-list"},tt=["onClick"],at={class:"text"},st={key:0,class:"tips"},ot={class:"space-info"},nt=W(()=>i("div",null,"空间使用",-1)),rt={class:"percent"},lt={class:"space-use"},it={class:"use"},ut={class:"body-content"},ct={__name:"Framework",setup(U){const{proxy:I}=G(),F=K(),P=Q(),p={getUseSpace:"/getUseSpace",logout:"/logout"},l=g(!1),w=g(),V=c=>{const{file:$,filePid:z}=c;l.value=!0,w.value.addFile($,z)},k=g(),R=()=>{Z(()=>{k.value.reload(),A()})},b=g(0),f=g(I.VueCookies.get("userInfo")),v=[{icon:"cloude",name:"首页",menuCode:"main",path:"/main/all",allShow:!0,children:[{icon:"all",name:"全部",category:"all",path:"/main/all"},{icon:"video",name:"视频",category:"video",path:"/main/video"},{icon:"music",name:"音频",category:"music",path:"/main/music"},{icon:"image",name:"图片",category:"image",path:"/main/image"},{icon:"doc",name:"文档",category:"doc",path:"/main/doc"},{icon:"more",name:"其他",category:"others",path:"/main/others"}]},{path:"/myshare",icon:"share",name:"分享",menuCode:"share",allShow:!0,children:[{name:"分享记录",path:"/myshare"}]},{path:"/recycle",icon:"del",name:"回收站",menuCode:"recycle",tips:"回收站为你保存10天内删除的文件",allShow:!0,children:[{name:"删除的文件",path:"/recycle"}]},{path:"/settings/fileList",icon:"settings",name:"设置",menuCode:"settings",allShow:!1,children:[{name:"用户文件",path:"/settings/fileList"},{name:"用户管理",path:"/settings/userList"},{path:"/settings/sysSetting",name:"系统设置"}]}],C=g({}),B=g(),u=c=>{!c.path||c.menuCode==C.value.menuCode||F.push(c.path)},r=(c,$)=>{const z=v.find(q=>q.menuCode===c);C.value=z,B.value=$};ce(()=>P,(c,$)=>{c.meta.menuCode&&r(c.meta.menuCode,c.path)},{immediate:!0,deep:!0});const o=g(),n=()=>{o.value.show(f.value)},t=()=>{f.value=I.VueCookies.get("userInfo"),b.value=new Date().getTime()},e=g(),s=()=>{e.value.show()},a=()=>{I.Confirm("你确定要删除退出吗",async()=>{await I.Request({url:p.logout})&&(I.VueCookies.remove("userInfo"),F.push("/login"))})},d=g({useSpace:0,totalSpace:1}),A=async()=>{let c=await I.Request({url:p.getUseSpace,showLoading:!1});c&&(d.value=c.data)};return A(),(c,$)=>{const z=S("el-popover"),q=S("Avatar"),J=S("el-dropdown-item"),oe=S("el-dropdown-menu"),ne=S("el-dropdown"),re=S("el-progress"),le=S("router-view");return h(),y("div",je,[i("div",Te,[Ee,i("div",Ge,[_(z,{width:800,trigger:"click",visible:l.value,"onUpdate:visible":$[0]||($[0]=x=>l.value=x),offset:20,transition:"none","hide-after":0,"popper-style":{padding:"0px"}},{reference:m(()=>[Oe]),default:m(()=>[_(Le,{ref_key:"uploaderRef",ref:w,onUploadCallback:R},null,512)]),_:1},8,["visible"]),_(ne,null,{dropdown:m(()=>[_(oe,null,{default:m(()=>[_(J,{onClick:n},{default:m(()=>[E(" 修改头像 ")]),_:1}),_(J,{onClick:s},{default:m(()=>[E(" 修改密码 ")]),_:1}),_(J,{onClick:a},{default:m(()=>[E(" 退出 ")]),_:1})]),_:1})]),default:m(()=>[i("div",Je,[i("div",He,[_(q,{userId:f.value.userId,avatar:f.value.avatar,timestamp:b.value,width:46},null,8,["userId","avatar","timestamp"])]),i("span",Ke,D(f.value.nickName),1)])]),_:1})])]),i("div",Qe,[i("div",We,[i("div",Xe,[(h(),y(T,null,H(v,x=>(h(),y(T,{key:x},[x.allShow||!x.allShow&&f.value.admin?(h(),y("div",{key:0,onClick:ie=>u(x),class:j(["menu-item",x.menuCode==C.value.menuCode?"active":""])},[i("div",{class:j(["iconfont","icon-"+x.icon])},null,2),i("div",Ze,D(x.name),1)],10,Ye)):M("",!0)],64))),64))]),i("div",et,[(h(!0),y(T,null,H(C.value.children,x=>(h(),y("div",{onClick:ie=>u(x),class:j(["menu-item-sub",B.value==x.path?"active":""]),key:x},[x.icon?(h(),y("span",{key:0,class:j(["iconfont","icon-"+x.icon])},null,2)):M("",!0),i("span",at,D(x.name),1)],10,tt))),128)),C.value&&C.value.tips?(h(),y("div",st,D(C.value.tips),1)):M("",!0),i("div",ot,[nt,i("div",rt,[_(re,{percentage:Math.floor(d.value.useSpace/d.value.totalSpace*1e4)/100,color:"#409eff"},null,8,["percentage"])]),i("div",lt,[i("div",it,D(O(I).Utils.size2Str(d.value.useSpace))+"/ "+D(O(I).Utils.size2Str(d.value.totalSpace)),1),i("div",{class:"iconfont icon-refresh",onClick:A})])])])]),i("div",ut,[_(le,null,{default:m(({Component:x})=>[(h(),L(de(x),{onAddFile:V,ref_key:"routerViewRef",ref:k,onReload:A},null,544))]),_:1})])]),_(ge,{ref_key:"updateAvatarRef",ref:o,onUpdateAvatar:t},null,512),_(Ce,{ref_key:"updatePasswordRef",ref:e},null,512)])}}},pt=ee(ct,[["__scopeId","data-v-2e64c336"]]);export{pt as default};
