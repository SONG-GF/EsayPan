import{_ as M,a as V,u as j,b as w,r as g,e as h,f as i,h as u,i as a,j as y,w as p,m as b,k as m,F as C,l as f,t as I,A as E,s as P,v as A}from"./index-28ee92df.js";const N=d=>(P("data-v-25de2ecd"),d=d(),A(),d),H={class:"top"},U=N(()=>a("span",{class:"iconfont icon-revert"},null,-1)),G=N(()=>a("span",{class:"iconfont icon-del"},null,-1)),J={class:"file-list"},K=["onMouseenter","onMouseleave"],Q=["title"],W={class:"op"},X=["onClick"],Y=["onClick"],Z={key:0},ee={__name:"Recycle",emits:["reload"],setup(d,{emit:S}){const{proxy:l}=V();j(),w();const n={loadDataList:"/recycle/loadRecycleList",delFile:"/recycle/delFile",recoverFile:"/recycle/recoverFile"},T=[{label:"文件名",prop:"fileName",scopedSlots:"fileName"},{label:"删除时间",prop:"recoveryTime",width:200},{label:"大小",prop:"fileSize",scopedSlots:"fileSize",width:200}],c=g({}),F={extHeight:20,selectType:"checkbox"},r=async()=>{let e={pageNo:c.value.pageNo,pageSize:c.value.pageSize};e.category!=="all"&&delete e.filePid;let s=await l.Request({url:n.loadDataList,params:e});s&&(c.value=s.data)},R=e=>{c.value.list.forEach(s=>{s.showOp=!1}),e.showOp=!0},x=e=>{e.showOp=!1},o=g([]),z=e=>{o.value=[],e.forEach(s=>{o.value.push(s.fileId)})},O=e=>{l.Confirm(`你确定要还原【${e.fileName}】吗？`,async()=>{await l.Request({url:n.recoverFile,params:{fileIds:e.fileId}})&&r()})},B=()=>{o.value.length!=0&&l.Confirm("你确定要还原这些文件吗？",async()=>{await l.Request({url:n.recoverFile,params:{fileIds:o.value.join(",")}})&&r()})},$=e=>{l.Confirm(`你确定要删除【${e.fileName}】？`,async()=>{await l.Request({url:n.delFile,params:{fileIds:e.fileId}})&&(r(),S("reload"))})},q=e=>{o.value.length!=0&&l.Confirm("你确定要删除选中的文件?删除将无法恢复",async()=>{await l.Request({url:n.delFile,params:{fileIds:o.value.join(",")}})&&(r(),S("reload"))})};return(e,s)=>{const k=h("el-button"),_=h("icon"),D=h("Table");return i(),u("div",null,[a("div",H,[y(k,{type:"success",disabled:o.value.length==0,onClick:B},{default:p(()=>[U,b("还原 ")]),_:1},8,["disabled"]),y(k,{type:"danger",disabled:o.value.length==0,onClick:q},{default:p(()=>[G,b("批量删除 ")]),_:1},8,["disabled"])]),a("div",J,[y(D,{columns:T,showPagination:!0,dataSource:c.value,fetch:r,options:F,onRowSelected:z},{fileName:p(({index:L,row:t})=>[a("div",{class:"file-item",onMouseenter:v=>R(t),onMouseleave:v=>x(t)},[(t.fileType==3||t.fileType==1)&&t.status!==0?(i(),m(_,{key:0,cover:t.fileCover},null,8,["cover"])):(i(),u(C,{key:1},[t.folderType==0?(i(),m(_,{key:0,fileType:t.fileType},null,8,["fileType"])):f("",!0),t.folderType==1?(i(),m(_,{key:1,fileType:0})):f("",!0)],64)),a("span",{class:"file-name",title:t.fileName},[a("span",null,I(t.fileName),1)],8,Q),a("span",W,[t.showOp&&t.fileId?(i(),u(C,{key:0},[a("span",{class:"iconfont icon-revert",onClick:v=>O(t)},"还原",8,X),a("span",{class:"iconfont icon-del",onClick:v=>$(t)},"删除",8,Y)],64)):f("",!0)])],40,K)]),fileSize:p(({index:L,row:t})=>[t.fileSize?(i(),u("span",Z,I(E(l).Utils.size2Str(t.fileSize)),1)):f("",!0)]),_:1},8,["dataSource"])])])}}},le=M(ee,[["__scopeId","data-v-25de2ecd"]]);export{le as default};
